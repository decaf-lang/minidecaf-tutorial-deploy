# 语法分析

本阶段引入了数组，但是为了简单不允许指向数组的指针，因此对语法的改动不算很大。

变量定义部分`ty`部分没有任何变化，只是变量名后面可以有零个或多个方括号括起来的整数，例如`int *a;`，`int **a[0][0];`都是合法的变量定义。需要注意的是变量定义允许方括号个数不为0时给变量赋初值，也就是说`int **a[0][0] = 0;`在语法上是合法的，语法分析阶段应该放过它，待后续的检查来汇报错误。

方括号内的整数依据前面的定义必须是非负的，所以不用担心数组的维度为负的情况，例如`int a[-1];`在语法上是不合法的，因为`-1`的标记列表包含两个元素：负号和整数1。

另一个变化在于表达式中`factor`可以有更多构造的形式了，包括一种：

```
factor
    : ...
    | expr '[' expr ']'
```

`factor`是整个表达式解析过程中最底层的元素，从优先级的角度来讲也就是`factor`相关的运算符的优先级最高，例如`a + b[1]`应该被解析成`a + (b[1])`而不是`(a + b)[1]`。

语法分析可能放过并没有合法语义的标记列表，例如`1[1]`依据语法定义是完全合法的，但是没有实际意义。这不是语法分析阶段需要考虑的问题，它可以输出这种不合法的AST，待后续的检查来汇报错误。